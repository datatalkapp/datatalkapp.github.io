
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataTalk for Legal</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/diff_match_patch/20121119/diff_match_patch.js"></script>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f8f9fa;
        }
        .container {
            max-width: 1300px;
        }
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }
        .result-item {
            cursor: pointer;
        }
        .selected {
            background-color: #e9ecef;
        }
        .diff-highlight {
            text-decoration: underline;
            text-decoration-color: #007bff;
            text-decoration-thickness: 2px;
        }
        #descriptionPanel {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 300px;
            background-color: #ffffff;
            border: none;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            z-index: 1000;
        }
        .btn {
            border-radius: 25px;
            padding: 10px 20px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .form-control {
            border-radius: 25px;
            padding: 10px 20px;
        }
        .alert {
            border-radius: 15px;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center mb-5">DataTalk for Legal</h1>
        <div class="row">
            <div class="col-md-10 offset-md-1">
                <div class="input-group mb-3">
                    <input type="text" id="searchInput" class="form-control" placeholder="Search for a clause...">
                    <button class="btn btn-primary" type="button" id="searchButton">Search</button>
                </div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-10 offset-md-1">
                <div id="searchResults"></div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-10 offset-md-1">
                <button id="combineButton" class="btn btn-success" style="display: none;">Combine Selected Clauses</button>
                <div id="combinedClause" class="mt-3"></div>
            </div>
        </div>
        <div class="row mt-4" id="feedbackSection" style="display: none;">
            <div class="col-md-10 offset-md-1">
                <div class="input-group mb-3">
                    <input type="text" id="feedbackInput" class="form-control" placeholder="Provide feedback on the combined clause...">
                    <button class="btn btn-primary" type="button" id="feedbackButton">Submit Feedback</button>
                </div>
                <div id="generatedClause" class="mt-3"></div>
            </div>
        </div>
    </div>

    <div id="descriptionPanel">
        <h5>DataTalk Legal Demo</h5>
        <p id="stepDescription"></p>
        <p><strong>Press the right arrow key to proceed to the next step.</strong></p>
    </div>

    <script>
    $(document).ready(function() {
        const sampleClauses = [
            {
                text: "The Employee agrees to maintain the confidentiality of all proprietary and non-public information obtained during their employment with the Company.",
                filename: "Employment_Contract_2023.docx",
                author: "John Doe",
                lastModified: "2023-05-15",
                keywords: ["confidentiality", "proprietary", "employment", "secrecy", "non-disclosure", "private", "classified"]
            },
            {
                text: "The Employee's obligation to maintain confidentiality shall continue following the termination of employment, regardless of the reason for such termination.",
                filename: "Severance_Agreement.docx",
                author: "Mike Johnson",
                lastModified: "2023-03-10",
                keywords: ["confidentiality", "termination", "obligation", "secrecy", "non-disclosure", "private", "classified"]
            },
            {
                text: "Confidential Information includes, but is not limited to, client lists, business strategies, financial data, trade secrets, and any other information designated as confidential by the Company.",
                filename: "NDA_Template.pdf",
                author: "Jane Smith",
                lastModified: "2023-04-22",
                keywords: ["confidential", "trade secrets", "business strategies", "secrecy", "proprietary information", "classified", "sensitive"]
            },
            {
                text: "The Contractor shall perform the services outlined in Exhibit A to the best of their ability and in accordance with industry standards.",
                filename: "Service_Agreement_2023.pdf",
                author: "Sarah Brown",
                lastModified: "2023-06-01",
                keywords: ["services", "contractor", "standards", "obligations", "performance", "duties", "responsibilities"]
            },
            {
                text: "Payment for services rendered shall be made within 30 days of invoice receipt.",
                filename: "Consulting_Contract.docx",
                author: "Tom Wilson",
                lastModified: "2023-05-28",
                keywords: ["payment", "invoice", "services", "compensation", "billing", "remuneration", "fee"]
            }
        ];

        let combinedClauseText = "";

        $('#searchButton').click(function() {
            const searchTerm = $('#searchInput').val().toLowerCase();
            const results = sampleClauses.filter(clause => 
                clause.text.toLowerCase().includes(searchTerm) || 
                clause.keywords.some(keyword => keyword.includes(searchTerm))
            );
            displayResults(results);
            $('#combinedClause').empty();
            $('#feedbackSection').hide();
            $('#generatedClause').empty();
        });

        function displayResults(results) {
    const $results = $('#searchResults');
    $results.empty();
    if (results.length === 0) {
        $results.append('<p>No results found.</p>');
    } else {
        const $row = $('<div class="row"></div>');
        results.forEach((clause, index) => {
            $row.append(`
                <div class="col-md-6 mb-3">
                    <div class="card h-100 result-item fade-in" data-index="${index}">
                        <div class="card-body">
                            <h5 class="card-title">${clause.filename}</h5>
                            <h6 class="card-subtitle mb-2 text-muted">Author: ${clause.author} | Last Modified: ${clause.lastModified}</h6>
                            <p class="card-text">${highlightSearchTerm(clause.text)}</p>
                            <button class="btn btn-sm btn-outline-primary view-doc-btn">View Document</button>
                        </div>
                    </div>
                </div>
            `);
        });
        $results.append($row);
    }
    $('#combineButton').show();
}

        function highlightSearchTerm(text) {
            const searchTerm = $('#searchInput').val();
            if (!searchTerm) return text;
            const regex = new RegExp(searchTerm, 'gi');
            return text.replace(regex, match => `<mark>${match}</mark>`);
        }

        $(document).on('click', '.result-item', function() {
            $(this).toggleClass('selected');
        });

        $(document).on('click', '.view-doc-btn', function(e) {
            e.stopPropagation();
        });

        $('#combineButton').click(function() {
            const selectedClauses = $('.result-item.selected').map(function() {
                return sampleClauses[$(this).data('index')].text;
            }).get();

            if (selectedClauses.length > 0) {
                combinedClauseText = selectedClauses.join(' ');
                $('#combinedClause').html(`<div class="alert alert-success fade-in">${combinedClauseText}</div>`);
                $('#feedbackSection').show();
            } else {
                $('#combinedClause').html('<div class="alert alert-warning fade-in">No clauses selected.</div>');
                $('#feedbackSection').hide();
            }
        });

        $('#feedbackButton').click(function() {
            const feedback = $('#feedbackInput').val();
            if (feedback) {
                const generatedClause = generateClause(combinedClauseText, feedback);
                const diffHtml = highlightDifferences(combinedClauseText, generatedClause);
                $('#generatedClause').html(`<div class="alert alert-info fade-in"><strong>Generated Clause:</strong><br>${diffHtml}</div>`);
            }
        });

        function generateClause(originalClause, feedback) {
            // This is a mock function to simulate AI-generated clause based on feedback
            // In a real application, this would be replaced with an actual AI model or API call
            let generatedClause = originalClause;

            if (feedback.toLowerCase().includes("duration")) {
                generatedClause = generatedClause.replace(
                    "The Employee's obligation to maintain confidentiality shall continue",
                    "The Employee's obligation to maintain confidentiality shall continue for a period of five (5) years"
                );
            }

            if (feedback.toLowerCase().includes("examples")) {
                generatedClause = generatedClause.replace(
                    "all proprietary and non-public information",
                    "all proprietary and non-public information, including but not limited to trade secrets, client lists, and financial data,"
                );
            }

            return generatedClause;
        }

        function highlightDifferences(oldText, newText) {
            const dmp = new diff_match_patch();
            const diffs = dmp.diff_main(oldText, newText);
            dmp.diff_cleanupSemantic(diffs);

            let html = '';
            for (let i = 0; i < diffs.length; i++) {
                const [type, text] = diffs[i];
                if (type === 0) {
                    html += text;
                } else if (type === 1) {
                    html += `<span class="diff-highlight">${text}</span>`;
                }
            }
            return html;
        }

        function showMockDocument() {
            const mockDocument = $(`
    <div id="mockDocument" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 60%; height: 80%; background: white; border: none; border-radius: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.2); z-index: 10000; padding: 30px; overflow-y: auto;">
                    <h2>Service Agreement 2023</h2>
                    <p>This Service Agreement (the "Agreement") is entered into as of [DATE] between [CLIENT NAME] ("Client") and [SERVICE PROVIDER NAME] ("Service Provider").</p>
                    <h3>1. Services</h3>
                    <p>The Contractor shall perform the services outlined in Exhibit A to the best of their ability and in accordance with industry standards.</p>
                    <h3>2. Payment</h3>
                    <p>Payment for services rendered shall be made within 30 days of invoice receipt.</p>
                    <h3>3. Confidentiality</h3>
                    <p>The Contractor agrees to maintain the confidentiality of all proprietary and non-public information obtained during the performance of services for the Client.</p>
                    <button id="closeMockDocument" class="btn btn-primary" style="position: absolute; top: 20px; right: 20px;">Close</button>
                </div>
            `);
            $('body').append(mockDocument);
            $('#closeMockDocument').click(function() {
                mockDocument.remove();
            });
        }

        const demoSteps = [
            {
                action: () => moveCursor(400, 200),
                description: "Moving the cursor to the search input field."
            },
            {
                action: () => clickElement('#searchInput'),
                description: "Clicking on the search input field to begin typing."
            },
            {
                action: () => typeText('#searchInput', 'classified'),
                description: "Typing 'classified' into the search input field to find relevant clauses."
            },
            {
                action: () => clickElement('#searchButton'),
                description: "Clicking the search button to perform the search."
            },
            {
                action: () => new Promise(resolve => setTimeout(resolve, 2000)),
                description: "Reviewing the search results for clauses containing 'classified' or related keywords."
            },
            {
                action: () => clickElement('.result-item:eq(0)'),
                description: "Selecting the first relevant clause from the search results."
            },
            {
                action: () => clickElement('.result-item:eq(1)'),
                description: "Selecting the second relevant clause from the search results."
            },
            {
                action: () => clickElement('#combineButton'),
                description: "Combining the selected clauses to create a unified confidentiality clause."
            },
            {
                action: () => new Promise(resolve => setTimeout(resolve, 2000)),
                description: "Reviewing the combined clause."
            },
            {
                action: () => clickElement('#feedbackInput'),
                description: "Preparing to provide feedback on the combined clause."
            },
            {
                action: () => typeText('#feedbackInput', 'Please add a specific duration for the confidentiality obligation'),
                description: "Requesting a modification to the clause to include a specific duration for the confidentiality obligation."
            },
            {
                action: () => clickElement('#feedbackButton'),
                description: "Submitting the feedback to generate an improved clause."
            },
            {
                action: () => new Promise(resolve => setTimeout(resolve, 2000)),
                description: "Reviewing the AI-generated clause with the requested modifications."
            },
            {
                action: () => {
                    $('#searchInput').val('');
                    return Promise.resolve();
                },
                description: "Clearing the search input field for a new search."
            },
            {
                action: () => clickElement('#searchInput'),
                description: "Clicking on the search input field to begin a new search."
            },
            {
                action: () => typeText('#searchInput', 'remuneration'),
                description: "Typing 'remuneration' to search for payment-related clauses."
            },
            {
                action: () => clickElement('#searchButton'),
                description: "Performing the search for payment-related clauses."
            },
            {
                action: () => new Promise(resolve => setTimeout(resolve, 2000)),
                description: "Reviewing the search results for payment-related clauses."
            },
            {
                action: () => clickElement('.view-doc-btn:first'),
                description: "Viewing the full document containing the selected payment clause."
            },
            {
                action: () => {
                    showMockDocument();
                    return new Promise(resolve => setTimeout(resolve, 5000));
                },
                description: "Examining the full document to understand the context of the payment clause."
            },
            {
                action: () => {
                    $('#mockDocument').remove();
                    return Promise.resolve();
                },
                description: "Closing the document view. This concludes the demonstration of the AI Contract Clause Search Tool."
            }
        ];

        let currentStep = 0;
    let isStepInProgress = false;

    function nextStep() {
        if (currentStep < demoSteps.length && !isStepInProgress) {
            isStepInProgress = true;
            const step = demoSteps[currentStep];
            $('#stepDescription').text(step.description);
            step.action().then(() => {
                currentStep++;
                isStepInProgress = false;
            });
        }
    }

    // Debounce function
    function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    }

    // Debounced nextStep function
    const debouncedNextStep = debounce(nextStep, 300);

    $(document).keydown(function(e) {
        if (e.which === 39) { // Right arrow key
            debouncedNextStep();
        }
    });

        $(document).keydown(function(e) {
            if (e.which === 39) { // Right arrow key
                nextStep();
            }
        });

        function moveCursor(x, y, duration = 1000) {
            return new Promise(resolve => {
                $('#cursor').animate({ left: x, top: y }, duration, resolve);
            });
        }

        function typeText(selector, text, delay = 50) {
            const element = $(selector);
            return new Promise(resolve => {
                let i = 0;
                const interval = setInterval(() => {
                    if (i < text.length) {
                        element.val(element.val() + text[i]);
                        i++;
                    } else {
                        clearInterval(interval);
                        resolve();
                    }
                }, delay);
            });
        }

        function clickElement(selector) {
            return new Promise(resolve => {
                const element = $(selector);
                const offset = element.offset();
                moveCursor(offset.left + element.width() / 2, offset.top + element.height() / 2)
                    .then(() => {
                        element.addClass('active');
                        setTimeout(() => {
                            element.removeClass('active');
                            element.click();
                            resolve();
                        }, 500);
                    });
            });
        }

        function initializeDemo() {
        const cursor = $('<div id="cursor" style="position: fixed; width: 20px; height: 20px; background: rgba(255, 0, 0, 0.5); border-radius: 50%; pointer-events: none; z-index: 9999;"></div>');
        $('body').append(cursor);
        $('#stepDescription').text("Welcome to the AI Contract Clause Search Tool demo. Press the right arrow key to begin.");
        isStepInProgress = false;
    }
        initializeDemo();
    });
    </script>
</body>
</html>